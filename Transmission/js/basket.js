function addTorrent(a){var b=(localStorage.dLocation==="dlcustom")?JSON.parse(localStorage.dirs):[];parseTorrent(a,function(c){if(c!==null){chrome.windows.create({url:"downloadTorrent.html",type:"popup",width:852,height:583},function(d){encodeFile(a,function(e){chrome.tabs.sendRequest(d.tabs[0].id,{torrent:c,data:e,dirs:b})})})}else{alert("This isn't a torrent file.")}})}function drop(d){var c=d.dataTransfer.files;if(c.length>5){alert("Select no more than 5 files!")}else{for(var b=0,a;a=c[b];++b){if(a.fileSize>200000){alert("File too large! Are you sure it's a torrent?");continue}addTorrent(a)}}d.stopPropagation();d.preventDefault()}function discard(a){a.stopPropagation();a.preventDefault()}(function(){var a=$("#dropbox");window.onUnload=function(){chrome.browserAction.setBadgeText({text:""})};a.addEventListener("dragenter",discard,false);a.addEventListener("dragover",discard,false);a.addEventListener("drop",drop,false);a.addEventListener("click",function(b){$("#hFile").click()},false)})();